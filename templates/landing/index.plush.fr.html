<div class="row">
  <div class="col-md-12">
    <div class="subtitle">
      <div class="container">
        <h3>Animaux en cours de soins</h3>
      </div>
    </div>
    
<div class="container p-3 my-3 border">
<form id="goto_animal" action="<%=animalsPath()%>">
  <div class="form-row">
    <div class="col-5">
      &nbsp;
    </div>
    <div class="col-2">
      <label for="goto_animalNumber" class="col-sm-2 col-form-label">ID&nbsp;de&nbsp;l'animal:&nbsp;</label>
    </div>
    <div class="col-4">
      <input name="animal_id" type="number" class="form-control" id="animal_id" placeholder="123" required>
    </div>
    <div class="col">
      <button type="submit" class="btn btn-primary">Go</button>
    </div>
  </div>
</form>
</div>

<% 
    let am = animalsByType 
    let keys = am.OrderedKeys()
%>

<ul class="nav nav-tabs" id="landing-abt" role="tablist">
  <%= for (i, at) in keys {%>
  <li class="nav-item">
    <a class="nav-link <%= if (i==0) {%>active<%}%>" id="<%= at.Name %>-tab" data-toggle="tab" href="#<%= at.Name %>" role="tab" aria-controls="home" aria-selected="true"><%= at.Name %></a>
  </li>
  <% } %>
</ul>

<div class="tab-content" id="landing-abt-content">
  <%= for (i, at) in keys {%>
  <div class="tab-pane fade <%= if (i==0) {%>show active<%}%>" id="<%= at.Name %>" role="tabpanel" aria-labelledby="<%= at.Name %>-tab">
    <table class="table table-hover table-bordered">
      <thead class="thead-light">
        <th>Numéro</th>
        <th>Date d'admission</th>
        <th>Cage</th>
        <th>Type</th>
        <th>Espèce</th>
        <th>Age</th>
        <th>Bague</th>
        <th>&nbsp;</th>
      </thead>
      <tbody>
        <%= for (animal) in am[at] { %>          
          <tr>
            <td class="align-middle"><%= animal.ID %></td>
            <td class="align-middle"><%= animal.Intake.DateFormated() %></td>
            <td class="align-middle"><%= animal.Cage %></td>
            <td class="align-middle"><%= animal.Animaltype.Name %></td>
            <td class="align-middle">
            <%
              let gender = "×"
              if (animal.Gender.Value()=="M") {
                gender = "♂"
              } else if (animal.Gender.Value() == "F") {
                gender = "♀"
              }
            %>
            <%= animal.Species %> (<%= gender %>)
            </td>
            <td class="align-middle"><%= animal.Animalage.Name %></td>
            <td class="align-middle"><%= animal.Ring %></td>
            <td>
              <div class="float-right">
                <%= linkTo(animalPath({ animal_id: animal.ID }), {class: "btn btn-info", title: "View", body: "<i class='fa fa-eye'></i>"}) %>
                <%= if (!animal.OuttakeID.Value() || current_user.Admin) {%>
                <%= linkTo(editAnimalPath({ animal_id: animal.ID }), {class: "btn btn-warning", title: "Edit", body: "<i class='fa fa-edit'></i>"}) %>
                <% } %>
                <%= if (current_user.Admin) {%>
                <%= linkTo(animalPath({ animal_id: animal.ID }), {class: "btn btn-danger", "data-method": "DELETE", "data-confirm": "Êtes-vous sûr?", title: "détruire", body: "<i class='fa fa-trash'></i>", style:"width:44px"}) %>
                <% } %>
              </div>
            </td>
          </tr>
        <% } %>
      </tbody>
    </table>
  </div>
  <%}%>
</div>

</div>
</div>