queries:
  - name: registre_detail
    description: REGISTRE DÉTAILLÉ
    query: SELECT distinct
            a.id AS "ID",
            a.year AS "année",
            a.yearNumber AS "N°",
            a.species AS "Espèce", 
            if((a.species) = (s.creaves_species), "", "NON CONNUE") AS "Check",
            a.cage AS  "cage",
            a.ring AS "Identification",
            a.gender AS "Genre",
            aa.name AS "Age",
            i.date AS "Date d'entrée",
            i.general AS "état général",
            i.wounds AS "Bléssures",
            i.parasites AS "Parasites",
            i.remarks AS "Remarque d'entrée",
            d.location AS "lieux de découverte",
            d.reason As "Cause de découverte",
            d.date AS "Date de découverte",
            d.note AS "Note sur la découverte",
            o.date AS "Date de sortie",
            oo.name AS "Raison de la sortie",
            o.location AS "Lieux de relacher",
            o.note As "Note sur la sortie",
            di.firstname AS "Prénom",
            di.lastname AS "Nom",
            di.address AS "Adresse",
            di.city AS "Ville",
            di.country AS "Pays",
            di.email AS "Adresse mail",
            di.phone AS "Téléphone",
            di.note AS "Note",
            DATEDIFF (o.date, i.date) + 1 AS "séjour",
            count(distinct vv.id) AS 'Nombre visite VT',
            sum(t.distance) AS "KM parcouru pour l'animal"
            FROM animals AS a
              INNER JOIN intakes AS i ON a.intake_id = i.id
              INNER JOIN discoveries AS d ON a.discovery_id = d.id
              INNER JOIN discoverers AS di ON d.discoverer_id = di.id
              INNER JOIN animalages AS aa ON a.animalage_id = aa.id
              LEFT JOIN species AS s ON s.creaves_species = a.species
              LEFT JOIN outtakes AS o ON a.outtake_id = o.id
              LEFT JOIN outtaketypes AS oo ON o.outtaketype_id = oo.id
              LEFT JOIN veterinaryvisits AS vv ON a.id = vv.animal_id
              LEFT JOIN travels AS t ON t.animal_id = a.id
              GROUP BY a.id
              ORDER BY a.id asc
              
- name: registre
    description: REGISTRE
    query: SELECT distinct
           year(i.date) AS "Année",
           a.yearNumber AS "N°",
           a.species AS "Espèce", 
           a.ring AS "Identification",
           d.location AS "lieux de découverte",
           i.date AS "Date d'entrée",
           d.reason As "Cause de découverte",
           oo.name AS "Raison de la sortie",
           o.date AS "Date de sortie",
           o.location AS "Lieux de relacher"
           FROM animals AS a
           INNER JOIN intakes AS i ON a.intake_id = i.id
           INNER JOIN discoveries AS d ON a.discovery_id = d.id
           INNER JOIN discoverers AS di ON d.discoverer_id = di.id
           INNER JOIN animalages AS aa ON a.animalage_id = aa.id
           LEFT JOIN species AS s ON s.creaves_species = a.species
           LEFT JOIN outtakes AS o ON a.outtake_id = o.id
           LEFT JOIN outtaketypes AS oo ON o.outtaketype_id = oo.id
           GROUP BY a.id
           ORDER BY a.yearNumber asc;


----------------------------------------------------------------------------------------------------------------------------------------

  - name: animals_types
    description: NOMBRE D'ANIMAUX ACCUEILLIS SELON LE TYPE
    query: SELECT year(i.date) as "Année", t.name AS "Type", COUNT(*) AS "Nombre"
           From animals AS a
           LEFT JOIN intakes i ON a.intake_id = i.id
           INNER JOIN animaltypes AS t ON a.animaltype_id = t.id
           GROUP BY year(i.date), a.animaltype_id
           ORDER BY 1 DESC
           
  - name: entry_day_week
    description: NOMBRE DENTREE SELON LE JOUR DE LA SEMAINE
    query: SELECT Year(i.date) AS "Année", Dayofweek(i.date) AS "numéro jour de la semaine - (1=dimanche)",  COUNT(*) AS "Nombre"
            FROM intakes AS i
            GROUP BY 1, 2
            ORDER BY 1 DESC, 2 ASC
            
  - name: entry_date_year
    description: NOMBRE D'ENTREE SELON LE JOURS DE L'ANNEE
    query: SELECT year(i.date) as "Année", date_format(i.date, "%Y %m %d") AS "Date d'Entrée", COUNT(*) AS "Nombre"
            From intakes AS i
            GROUP BY 1, 2
            ORDER BY 1 DESC, 2 ASC
